### webkit 架构和模块
详细感兴趣的同学，可以仔细查阅书籍，这里笔者依据自身当前认为的重点归纳。可能下一次阅读，又非如此了。

1. webkit架构和模块  （由基础到应用）

1）操作系统：包括2D/3D图形库，网络库，存储，音视频库，...提供底层服务   
2）webkit层：包括webCore,jsCore,webkit Ports(对操作系统提供基础服务的封装的接口调用),等   
   2.1） webCore:对html解析-->构建dom，对css的解析-->构建cssOM。到构建render Object tree--->layout--->render layout tree.以及对svg，canvas等的解析。  
    2.2）jsCore：提供对js的解释和解析。
    
3）webkit 接口层：提供对webkit功能的绑定和对应接口输出。


了解了webkit的简单分层，再来看下chromium的结构实现。
架构层次清晰，模块功能越单一，灵活性越强，可拓展性越强。

2. chromium的模块架构
    从下到上。   
    2.1） 基础服务模块：
    blink(webkit)，v8（处理js的模块），GPU,UI,...
    (主要是html,css,js的解析，渲染和绘制的基础模块)  
    2.2）content 模块和 content 接口
    content 模块和 content 接口的目的是隐藏基础服务逻辑功能，提供简单的接口调用。   
    2.3）chromiun等浏览器客户端程序
        更合理和有效的组织接口调用，提供从url到页面展示的功能。

那引出下一个问题，怎么更合理和有效的组织呢？  
目前最有效的方式是多进程，多线程架构模型。  
目的都是为了安全和高效快速。  

3. chromium的多进程架构模型  
    基础进程有：  
    3.1) browser进程：
    浏览器的主进程，负责浏览器界面的展示，以及浏览器页面的管理（和绘制），负责其他进程的创建和销毁。以及浏览器的TAB的前进、后退、地址栏、书签栏的工作和处理浏览器的一些不可见的底层操作，比如网络请求和文件访问后面涉及缓存资源的管理等。 有且仅有一个。    
        主要线程：   
            UI线程：负责处理用户事件，以及绘制从render进程接收到的数据。
            IO线程：负责传递数据or任务。

    3.2）render进程： 渲染进程，主要负责页面的渲染，webkit的渲染工作主要在这个进程完成。render进程的数量并不一定与浏览器对应打开的页面一样，会更多，有能有内嵌的iframe，可能有webworker进程事件导致。   
        主要线程：   
            a. GUI渲染线程：负责渲染浏览器界面，解析 HTML，CSS，构建 DOM 树和 RenderObject 树，布局和绘制等。    
            b. js线程：负责处理 Javascript 脚本程序。（例如 V8 引擎）  
            c. 事件触发线程：归属于浏览器而不是 JS 引擎，用来控制事件循环；  
            d. IO线程：   
            e.定时触发器线程:setInterval 与 setTimeout事件  
            f.异步http请求线程   

> 浏览器的event loop ?



    3.3）GPU进程：主要用于图像加速，当前仅当GPU硬件加速开启的时候才会被创建，最多只有一个。
    >这么引出一个问题，怎么开启GPU硬件加速？

    3.4）其他...

    对进程模型的优点很明显：多进程调用，充分发挥多核cpu效率；browser进程和render进程分开，避免render进程崩溃影响这个浏览器；不同render进程分开，互不影响，也保证了安全（不同进程间不能随意获取内存数据）；等等。
    不过也有不好的一面，也就是进程间的通信的复杂度和消耗也要加大。
    >这么引出一个问题，进程间通信的方法？
   

4. 多线程模型
    学过操作系统，我们都知道，进程是内存分配的最小单位，线程是计算机调度的最小单位。一个进程下可以有好多线程，而chromium设计多线程的目的是为了更高效的调控，保持用户界面的高响应度。   
    如何保证用户界面的高响应度呢？   
    a.对于browser进程，需要保证UI线程不会其他费时的操作阻碍而影响用户对界面的操作。
    b. 对于render进程，保证在执行渲染线程时，不让其他操作阻碍。更甚者，可以利用多核的优势，将渲染过程管线化，这样可以让渲染的不同阶段在不同的线程中。
    >抛出问题：什么是官线化？


总结，多于进程和线程的划分，是应该创建一个进程，还是创建线程，也是一个需要权衡的。

------未完待续----